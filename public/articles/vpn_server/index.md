# Свой VPN для самых маленьких | 3X-UI &#43; VLESS


&lt;center&gt;{{&lt; image src=&#34;/images/feature.png&#34; &gt;}}&lt;/center&gt;

Дисклеймер: Материл носит исключительно информационный характер. Автор не призывает к каким-либо действиям.

Статья-гайд, посвящённая установке своего VPN-сервера(вернее прокси) на удалённом хостинге с помощью 3X-UI панели и протокола VLESS/XTLS-Reality

&lt;!--more--&gt;

А вот и гайдик подъехал. Плюсы своего VPN-сервера, что такое VPS и VLESS мы обговаривали в [предыдущей статье](/articles/anonymity/), сейчас же пошагово разберёмся, как его настроить, также обсудим некоторую теоретическую часть по ходу установки.

Тут будет много работы с терминалом, поэтому желательно понимать, как взаимодействовать с этой сущностью. В Windows можно работать через PowerShell/cmd от имени администраторы, в macOS — через стандартный терминал. Если у вас Linux — вы и без меня всё знаете :)

## Аренда сервера
Покупаем VPS/VDS. Я пользуюсь [HSHP](https://hshp.host/virtual-servers), но он может затянуть с выдачей IP. Примеры хороших хостингов, которые можно оплатить из рф или криптой можно найти [здесь](https://amnezia.org/ru/starter-guide) и [здесь](https://github.com/hiddify/awesome-freedom/blob/main/vps-providers.md). Разумеется, при покупке нужно выбирать расположение сервера вне России. Для личного пользования хватит 1 ядра и 1гб RAM, желательно хотя бы 10гб на диске, ОС — Ubuntu 22.04 (для других дальнейшие инструкции могут не подойти). Также важным фактором для нас является скорость передачи данных. По-хорошему нужно брать от 500мбит/сек, но для тестового показа я арендую дешёвенький VPS со 100мбит/сек.

&lt;center&gt;{{&lt; image src=&#34;/images/VPS.png&#34; &gt;}}&lt;/center&gt;

## Первое подключение к серверу
На своём пк открываем терминал/Bash/PowerShell от имени администратора. Пишем следующую команду `ssh root@ip_сервера`, где вместо &#34;ip_сервера&#34;, соответственно, вставляем ip своего сервера. Терминал сначала спросит, точно ли мы хотим подключиться — пишем &#34;yes&#34;, затем предложит ввести пароль, скорее всего при покупке хостинг самостоятельно сгенерировал его, ищем на почте или на странице купленной услуги.

{{&lt; admonition info &gt;}}
Вставка текста в терминал осуществляется либо клавишами `Ctrl &#43; Shift &#43; V`, либо правой кнопкой мыши (PowerShell/cmd/PuTTY).  
При вбивании пароля символы отображаться не будут, поэтому удобнее делать копи-пастом. Если не получается авторизоваться, хотя пароль правильный, измените раскладку клавиатуры на английскую.
{{&lt; /admonition &gt;}}

{{&lt; admonition info &gt;}}
SSH — сетевой протокол, позволяющий удалённо управлять ОС
{{&lt; /admonition &gt;}}

&lt;center&gt;{{&lt; image src=&#34;/images/ssh.png&#34; &gt;}}&lt;/center&gt;

Если вы видите приглашение типа `root@host_name` — вы внутри, поздравляю! Да, тут нет привычного графического интерфейса как в обычном пк, но он и не нужен, ведь всё можно сделать через консоль. 

## Защита сервера
root — стандартная учётная запись администратора, которая чаще других становится целью брутфорс-атак (перебора паролей). Обезопасим себя, создав нового пользователя и запретив вход для root (также называемого суперпользователем). Пишем `adduser новое_имя`, придумываем сложный пароль и вбиваем/вставляем его. Для генерации сильных паролей я использую KeePass. Дальше нажимаем `Enter` несколько раз, пока не появится вопрос. Жмём `y`. Даём новому пользователю возможность выполнять команды от имени суперпользователя: `usermod -aG sudo имя_пользователя`, выходим из системы командой `exit` либо закрывая терминал.

&lt;center&gt;{{&lt; image src=&#34;/images/passwd.png&#34; &gt;}}&lt;/center&gt;

Зайдём под именем созданного пользователя: `ssh имя_пользователя@ip_сервера`, и проверим работоспособность командой `sudo ls -la /root`. Вывод есть? Значит всё хорошо, идём дальше.

Теперь перед каждой командой, требующей доступ администратора, нам придётся писать `sudo` и вводить пароль (единоразово для сессии), ведь мы работаем не через суперпользователя, имеющего доступ ко всему и вся.

&lt;center&gt;{{&lt; image src=&#34;/images/new_user.png&#34; &gt;}}&lt;/center&gt;

Так, пора бы обновить систему. Пишем `sudo apt update &amp;&amp; sudo apt full-upgrade -y` и ждём. 

Установим nano: `sudo apt install nano`, откроем конфиг SSH командой `sudo nano /etc/ssh/sshd_config` и изменим параметр &#34;PermitRootLogin&#34; с &#34;yes&#34; на &#34;no&#34;.

{{&lt; admonition info &gt;}}
nano — консольный текстовый редактор Linux (UNIX-подобных ОС). Он покажется довольно специфичным юзеру, пользовавшемся только графическими редакторами, поэтому вот пару советов, которые могут вам помочь:
1. Передвигать курсор мышкой не получится, впрочем как и во всём терминале, так что используйте для этого стрелки на клавиатуре.
2. Нажмите `Ctrl &#43; O -&gt; Enter`, чтобы сохранить файл; Нажмите `Ctrl &#43; X`, чтобы выйти из редактора.
{{&lt; /admonition &gt;}}

&lt;center&gt;{{&lt; image src=&#34;/images/nano.png&#34; &gt;}}&lt;/center&gt;

Так лучше, теперь root не сможет зайти в систему никоим образом. Ещё один важный шаг: нужно перевесить порт SSH с дефолтного на повыше. Открываем (если уже закрыли) тот же самый файл sshd_config, раскомментируем строку &#34;Port&#34;, убрав `#` и пишем произвольный номер порта. Нужно запомнить его.

{{&lt; admonition info &gt;}}
IP — адрес сетевого устройства, порт — адрес сетевой службы/программы на этом IP
{{&lt; /admonition &gt;}}

&lt;center&gt;{{&lt; image src=&#34;/images/nano2.png&#34; &gt;}}&lt;/center&gt;

{{&lt; admonition info &gt;}}
Если вам надоело, что соединение с сервером теряется после нескольких минут бездействия, измените значения параметров `ClientAliveInterval` и/или `ClientAliveCountMax` на более высокие. У меня стоят 300 и 12 соответственно
{{&lt; /admonition &gt;}}

Не забываем перезапустить службу SSH: `sudo systemctl restart sshd`.  
Выйдем и зайдём нормально :D  
Прописываем `exit`, затем подключаемся к серверу с нового порта: `ssh имя_пользователя@ip_сервера -p номер_порта`. 

Все предыдущие шаги были сделаны с целью обезопасить систему от непрошеных гостей. Сейчас же начнём установку **3X-UI** панели, которая облегчит настройку XRay и даст графический интерфейс. 

&gt; \- Так, стоп, а что за XRay?  
\- **XRay** — ПО, выполняющее функции прокси. Оно не является таковым в физическом смысле, но содержит протоколы, транспорты и всё нужное для работы прокси-сервера.

&gt; \- Окей, кажется ещё упоминались какие-то VLESS и Reality?  
\- **VLESS** — протокол передачи данных, поддерживающий технологии маскировки, к примеру **XTLS-Reality**, позволяющий скрыть трафик под обычные HTTPS запросы.

&gt; \- Я запутался...  
\- Давайте ещё разок с самого начала. VPS — виртуальный сервер, размещённый на физическом. В нашем случае он находится где-то в Германии. На нём установлена операционная система, вроде Windows, но не он, а дистрибутив (реализация) Linux, называемый Ubuntu. На эту ОС мы накатим 3X-UI — программу, которая облегчит настройку XRay — ПО для маршрутизации и проксирования трафика, использующее для этой цели протоколы по типу VLESS, а последний, в свою очередь, улучшает свой функционал, работая с технологией XTLS-Reality, которая позволит маскироваться под определённый сайт. Фух, ну с объяснениями вроде закончили...

## Установка 3x-ui
Вернёмся к практической части. Выполняем последовательность следующих команд:
```bash
sudo apt install docker.io docker-compose -y
git clone https://github.com/MHSanaei/3x-ui.git
cd 3x-ui
sudo nano docker-compose.yml
```
Изменим строчки, начинающиеся с $PWD на:
```yml
      - /home/имя_пользователя/3x-ui/db/:/etc/x-ui/
      - /home/имя_пользователя/3x-ui/cert/:/root/cert/
```  
Выйдем из файла, предварительно сохранив изменения -&gt; вставляем `sudo docker-compose up -d`

Готово. Теперь переходим в браузер, в поисковой строке вбиваем `http://ip_сервера:2053/panel/`. В качестве логина и пароля вводим дефолтные admin/admin.

&lt;center&gt;{{&lt; image src=&#34;/images/3x-ui.png&#34; &gt;}}&lt;/center&gt;

## Защита панели
Хорошо, панель есть. Теперь нужно защитить её от тех же брутфорс-атак. Для этого переходим в настройки и:

1. Меняем корневой путь URL адреса. У меня будет `/kekw/` (запишите его).

2. Меняем порт панели. Желательно выбрать в пределах от 60000 до 65535 (также запомните или запишите).

&lt;center&gt;{{&lt; image src=&#34;/images/settings1.png&#34; &gt;}}&lt;/center&gt;

{{&lt; admonition info &gt;}}
Чтобы изменить язык на русский, выберите страну в настройках в поле &#34;Language&#34;
{{&lt; /admonition &gt;}}

Сохраните настройки и перезапустите панель. Теперь вы сможете войти в неё по следующему URL: `http://ip_сервера:указанный_порт/корневой_путь/`

3. На странице &#34;Настройки безопасности&#34; измените стандартные логин и пароль.

&lt;center&gt;{{&lt; image src=&#34;/images/settings2.png&#34; &gt;}}&lt;/center&gt;

## Настройка VLESS и Reality
Теперь, наконец-таки, займёмся подключением протокола! Переходим во вкладку &#34;Подключения&#34; (Inbounds) и жмём плюсик. 

В &#34;Примечании&#34; (Remark) пишем любое название подключения, протокол — VLESS, &#34;Порт IP&#34; (Listening IP) — пустой, порт — 443.

&lt;center&gt;{{&lt; image src=&#34;/images/vless1.png&#34; &gt;}}&lt;/center&gt;

В настройках клиента меняем Email (по факту никнейм) на что-то уникальное и удобочитаемое. ID сгенерировано панелью, общий расход и дату окончания устанавливаем по усмотрению, я же оставлю эти поля пустыми. 

&lt;center&gt;{{&lt; image src=&#34;/images/vless2.png&#34; &gt;}}&lt;/center&gt;

Ниже в строке &#34;Безопасность&#34; выбираем &#34;Reality&#34;, после чего в настройках клиента появляется строка &#34;Flow&#34;. В выпадающем окне жмём на &#34;xtls-rprx-vision&#34;.

Возвращаемся к настройке транспорта. В &#34;uTLS&#34; выбирайте что хотите из знакомого и популярного, я оставил chrome. 

В &#34;Dest&#34; прописываем адрес сайта, по которому будет перенаправляться подключения для маскировке трафика. Вот тут сложнее. Желательно выбрать сайт из той же сети, в которой находится наш сервер, чтобы пинг и шанс блокировки сервера были ниже.  
Для Windows/Linux можно использовать [эту утилиту](https://github.com/XTLS/RealiTLScanner/releases/). Переходим по ссылке, качаем на ХОСТ (т.е. ваш пк), открываем командную строку, переходим в папку скачивания и запускаем программу (для Windows: Win&#43;R -&gt; `cmd` -&gt; `cd Downloads` -&gt; `.\RealiTLScanner-windows-64 -addr ip_сервера`). Ждём несколько минут, нажимаем Ctrl&#43;C и смотрим на вывод (также можно открыть созданный `.csv` файл).

Получили что-то такое:

&lt;center&gt;{{&lt; image src=&#34;/images/reality.png&#34; &gt;}}&lt;/center&gt;

Мда, не густо. Возможно дело в дешевизне хостинга VPS, ну да неважно. Главное выбрать популярный зарубежный сайт, который заблокируют с наименьшей долей вероятности для жителей РФ. Также важно учесть пинг: в идеале он должен быть &lt;10мс. Проверить можно командой `ping выбранный_сайт` (Ctrl &#43; C, чтобы остановить процесс).

Я выберу google.com:443, основываясь на вышеуказанных критериях. В &#34;SNI&#34; указываем &#34;google.com,www.google.com&#34;.  
Отныне провайдер будет думать, что вы подключаетесь к google.com, даже если вы находитесь на nelzagram.com.

&#34;Sniffing&#34; рекомендуется оставлять по дефолту, но я включил 🤷‍♂️.

&lt;center&gt;{{&lt; image src=&#34;/images/vless3.png&#34; &gt;}}&lt;/center&gt;

## Подключение к VPN
Готово! Осталось только подключиться. Для этого воспользуемся каким-либо из клиентов. Для любых устройств я рекомендую [Hiddify](https://github.com/hiddify/hiddify-app). Чтобы скачать его, перейдите по ссылке или найдите репозиторий в поисковике, промотайте вниз до &#34;Direct Download&#34; и выберите свою платформу.

Вернёмся к панельке. Сейчас имеем такую ситуацию:

&lt;center&gt;{{&lt; image src=&#34;/images/inbound1.png&#34; &gt;}}&lt;/center&gt;

Жмём на плюсик рядом с &#34;ID&#34;, выпадут текущие пользователи. Тыкаем на значок qr-кода, затем на сам высветившийся qr — ссылка будет скопирована в буфер обмена.

&lt;center&gt;{{&lt; image src=&#34;/images/inbound1.png&#34; &gt;}}&lt;/center&gt;

Теперь откроем Hiddify. Жмём на плюсик в правом верхнем углу, далее на &#34;Добавить из буфера обмена&#34;. Осталось нажать на центральную кнопку.. та-дам! Всё работает, можно пользоваться :)

&lt;center&gt;{{&lt; image src=&#34;/images/hiddify.png&#34; &gt;}}&lt;/center&gt;

В параметрах конфигурации вы можете поставить регион ru, чтобы подключаться к сайтам с доменами `.ru` напрямую — так шанс идентификации использования прокси приближается к нулю. Если же всякие нельзяграммы так и не работают, измените в настройках режим работы на &#34;VPN&#34;. Учтите, что в этом случае нужно будет открыть приложение с правами администратора. У меня, к примеру, по дефолту режим стоял &#34;Прокси&#34;.

&lt;center&gt;{{&lt; image src=&#34;/images/hiddify2.png&#34; &gt;}}&lt;/center&gt;

Схема подключения на мобильных устройствах практически идентична. Ссылку можете получить, отсканировав qr или переслав через тот же телеграм. Также нужно выбрать режим работы VPN и установить регион по желанию. К слову, я использую VPN для всех сайтов (регион — Другой), и за полтора месяца проблем не было.

&lt;center&gt;{{&lt; image src=&#34;/images/hiddify_android.png&#34; &gt;}}&lt;/center&gt;

### Пользователи
Для каждого подключения есть возможность создать несколько пользователей. Для чего? Ну можно следить за расходом трафика, ограничивать его, задавать начальную и окончательную даты использования и может что-то ещё... 

Создать новых пользователей очень просто. Ищем наше подключение, нажимаем на значок &lt;i class=&#34;fa-solid fa-ellipsis-vertical&#34;&gt;&lt;/i&gt; под &#34;Меню&#34; -&gt; &#34;&lt;i class=&#34;fa-solid fa-user-plus&#34;&gt;&lt;/i&gt; Добавить пользователя&#34;. В качестве Email пишем уникальное имя, а в качестве Flow устанавливаем тот же &#34;xtls-rprx-vision&#34;.

&lt;center&gt;{{&lt; image src=&#34;/images/add_user.png&#34; &gt;}}&lt;/center&gt;

Супер, теперь у нас есть 2 пользователя. Ко второму может подключиться, например, наш друг. Просто берём ссылку, нажав на соответствующий qr в строке пользователя.

&lt;center&gt;{{&lt; image src=&#34;/images/add_user2.png&#34; &gt;}}&lt;/center&gt;

{{&lt; admonition warning &gt;}}
Рассчитайте, сколько устройств смогут комфортно пользоваться вашим прокси. Если вы дадите доступ слишком большому количеству людей, серверу может банально не хватить пропускной способности. Для скорости в 500мбит/c я бы ограничился 25 устройствами.
{{&lt; /admonition &gt;}}

## Установка сертификата
Вверху панели вы наверняка заметили предупреждение о том, что соединение не защищено. Так и есть, ведь мы подключаемся к этой панели по протоколу http, а вот чтобы подключаться по https, нам нужен SSL/TLS сертификат. Разберём два способа подключения этой сущности.

### Способ 1
Вообще сертификаты TLS подписываются специализированными центрами, но такой вариант может подойти не всем, так как он требует наличия домена, а это либо затраты &#43; раскрытие своих паспортных данных, либо ненадёжные бесплатные поддомены, так что обучу вас тайной технике самоподписи...

Будем пользоваться утилитой OpenSSL. Снова подключаемся к нашему серверу: `ssh имя_пользователя@ip_сервера -p номер_порта` -&gt; вводим пароль. Скачиваем пакеты: `sudo apt install openssl` (хотя скорее всего уже установлены) -&gt; снова вводим пароль.

Перейдём в папку, куда устанавливали панель и создадим там директорию, где будут храниться ключи (если после второй команды вылезает ошибка, проигнорируйте её):
```bash
cd 3x-ui
mkdir cert
cd cert
```

Теперь создадим приватный ключ командой `openssl genrsa -out private.key 2048`, где вместо &#34;private&#34; вы можете вставить любое имя для ключа. 

Далее, создаём запрос на подпись сертификата: `openssl req -key private.key -new -out public.csr`, где вместо &#34;public&#34; вы также можете вставить любое имя. Сейчас у нас будут спрашивать информацию о нашем сайте / компании, которую он представляет. Оставляем всё по умолчанию, нажимая `Enter`, КРОМЕ пункта &#34;Common Name&#34;, где вписываем ip VPS сервера.  
И, наконец, самостоятельно подписываем сертификат: `openssl x509 -signkey private.key -in public.csr -req -days 3650 -out public.crt`, где вместо &#34;3650&#34; вы можете вставить любое число дней, на которое хотите подписать сертификат. По истечении срока вам снова придётся его подписать или создать новый.

Посмотрим, что имеется в папке cert:

&lt;center&gt;{{&lt; image src=&#34;/images/openssl.png&#34; &gt;}}&lt;/center&gt;

Отлично, все файлы на месте.  
Открываем панельку и бежим в настройки. В поле &#34;Путь к файлу публичного ключа сертификата панели&#34; вводим `/root/cert/public.crt`, а в поле &#34;Путь к файлу приватного ключа сертификата панели&#34; вводим `/root/cert/private.key`. Нажимаем &#34;Сохранить&#34; в верхней левой части. 

Сохранилось? Ну и славно. Перезапускаем панель и видим предупреждение браузера:

&lt;center&gt;{{&lt; image src=&#34;/images/browser-warning.png&#34; &gt;}}&lt;/center&gt;

Это нормально, просто хром в курсе, что сертификат самоподписанный, но нехотя установит https соединение, если мы всё таки перейдём по ссылке.

Ну что там, проверяем... Ура! Красное предупреждение исчезло 🥳

### Способ 2
А для тех, кто не хочет испытывать на себе буллинг со стороны браузеров, я покажу как получить сертификат, подписанный сертифицированным центром. Так, что там нужно.. ах да, для начала — домен. Тут либо покупать, либо использовать бесплатные поддомены, я воспользуюсь вторым вариантом.

Переходим на [сайт](https://freedns.afraid.org/signup/) и регистрируемся. К слову, кроме корректного email&#39;а, вы можете ввести выдуманные данные. Активируем аккаунт через письмо на почте, [тыкаем сюда](https://freedns.afraid.org/domain/registry/) и выбираем желаемый ПУБЛИЧНЫЙ домен -&gt; попадаем в окно настройки. В поле &#34;Subdomain&#34; пишем имя, которое хотим видеть перед основным доменом, в &#34;Destination&#34; вставляем ip сервера -&gt; сохраняем. Готово.

&lt;center&gt;{{&lt; image src=&#34;/images/subdomain.png&#34; &gt;}}&lt;/center&gt;

Возвращаемся в консоль. Как и в первом способе, переходим в папку cert и используем OpenSSL: `openssl genrsa -out private.key 2048`; `openssl req -key private.key -new -out public.csr` — здесь также прожимаем Enter везде, КРОМЕ пункта &#34;Common Name&#34;, где вписываем ДОМЕН, который только что создали.

Установим новую утилиту, которая отправит наш сертификат на подпись в центр и запросим эту подпись:
```bash
docker-compose down
sudo apt install certbot
certbot certonly --csr public.csr --email email_адресс --agree-tos --no-eff-email
1
cat 0000_cert.pem 0000_chain.pem &gt; public.pem
docker-compose up -d
```

{{&lt; admonition warning &gt;}}
Если на этом этапе вы получили отказ из-за слишком большого количества выданных сертификатов за последнее время &#34;There were too many requests of a given type :: too many certificates (50) already issued for...&#34;, то нужно либо подождать указанное время и попробовать снова, либо получить и попробовать новый поддомен, расположенный в другой доменной зоне (в моём случае не &lt;name&gt;.strangled.net).
{{&lt; /admonition &gt;}}

По той же схеме переходим в настройки панели и пишем пути для сертификата в соответствующих полях: `/root/cert/public.pem` — путь к публичному ключу, а `/root/cert/private.key` — путь к приватному ключу.

Вот и всё, теперь браузеры не будут ругаться! А чтобы так было, впредь нужно заходить в 3x-ui панель по следующему адресу: `https://домен:указанный_порт/корневой_путь/`.

## Telegram бот
Интересная фича, которая позволит вам управлять панелью через Telegram бота. Делается всё очень и очень просто.

Для начала переходим к [@BotFather](https://t.me/BotFather), стартуем -&gt; /newbot -&gt; Пишем любое имя -&gt; Пишем юзернейм с &#34;bot&#34; на конце -&gt; Копируем токен и вставляем его в панели в соответствующую строку в настройках Telegram бота. Сохраняем изменения и перезапускаем панель.

&lt;center&gt;{{&lt; image src=&#34;/images/bot.png&#34; &gt;}}&lt;/center&gt;

Перейдём по ссылке к боту. Получаем свой id командой, как ни странно, `/id`, и также вставляем в панель, снова перезапуская её. Теперь бот знает, что вы — ~~хозяин~~ админ.

&lt;center&gt;{{&lt; image src=&#34;/images/bot2.png&#34; &gt;}}&lt;/center&gt;

Панель сейчас выглядит как-то так:

&lt;center&gt;{{&lt; image src=&#34;/images/bot3.png&#34; &gt;}}&lt;/center&gt;

По желанию вы можете настроить и другие параметры, например, частоту отправки уведомлений или язык бота. 

Так, хорошо, посмотрим, что умеет бот. Снова пишем `/start` — выпадает менюшка. Видим: Использование сервера, бэкапы баз данных, настройки подключений и их пользователей, просмотр онлайн клиентов и т.п. Также без подключения к самой панели через бота можно перезапускать ядро командой `/restart force`. 

&lt;center&gt;{{&lt; image src=&#34;/images/bot4.png&#34; &gt;}}&lt;/center&gt;

Можно сделать так, чтобы пользователи тоже смогли просматривать свой объём используемого трафика. Для этого следуйте &#34;All Clients&#34; -&gt; &#34;имя_подключения&#34; -&gt; &#34;имя_пользователя&#34; -&gt; &#34;Set Telegram User&#34; -&gt; &#34;Select Telegram User&#34;. Теперь пользователь вашего VPN может просматривать свою информацию (но не более того).

&lt;center&gt;{{&lt; image src=&#34;/images/bot5.png&#34; &gt;}}&lt;/center&gt;

Поздравляю, бот готов!

## Подписки
Тоже довольно интересная функция, позволяющая придать процессу создания своего VPN коммерческий вектор. С помощью подписки можно создать ссылку сразу на несколько подключений, то есть у пользователя появится сразу несколько конфигураций VPN в клиенте, к тому же, изменения будут подтягиваться автоматически (без подписки придётся удалять и создавать подключения в клиенте заново). Вдруг какой-то перестанет работать, а тут второй как раз под рукой.

Чтобы активировать эту функцию, переходим в настройки панели -&gt; &#34;Подписка&#34; и включаем службу. Пути к файлам сертификатов выбираем те же (оставьте пустыми, если сертификат самоподписанный), что делали для самой панели, корневой путь подписки меняем на произвольный. Порт выставляем какой-нибудь другой, но он не должен использоваться другими службами на вашем VPS. Чтобы проверить прослушиваемые порты, вбейте `ss -ntlp`. Выбираем любой четырёх/пятизначный НЕ из этого списка.

&lt;center&gt;{{&lt; image src=&#34;/images/ss.png&#34; &gt;}}&lt;/center&gt;

Можно также изменить URI путь в подписке json, чтобы избавиться от предупреждения.

Сохраняем конфиг и перезапускаем панельку. Получили что-то подобное:

&lt;center&gt;{{&lt; image src=&#34;/images/subscription.png&#34; &gt;}}&lt;/center&gt;

Теперь можем подключать клиентов к подписке. Для этого идём в подключения -&gt; &#34;&lt;i class=&#34;fa-solid fa-pen&#34;&gt;&lt;/i&gt; Редактировать пользователя&#34;. В выпашем окне в поле &#34;Subscription&#34; пишем название подписки. Это же название вы будете писать каждый раз, когда хотите присоединить клиента в другом подключении к этой подписке. Сохраняем изменения.

&lt;center&gt;{{&lt; image src=&#34;/images/subscription2.png&#34; &gt;}}&lt;/center&gt;

**P.S. Для примера я сделал второе подключение и вписал идентичное название подписки для его клиента.**

Выбираем подключение и клиента, которому присвоили подписку, жмём на значок qr, затем на qr-код ПОДПИСКИ. Возвращаемся в Hiddify -&gt; Ctrl &#43; V. Видим новый профиль и значок перезагрузки рядом с ним. С помощью него мы и будем обновлять подписку, если понадобится вытянуть изменения настроек подключений 3x-ui панели. Также в левой менюшке &#34;Прокси&#34; можно выбрать конкретное подключение, которое вам нужно в данный момент.

&lt;center&gt;{{&lt; image src=&#34;/images/hiddify3.png&#34; &gt;}}&lt;/center&gt;

Вот гайд и подошёл к концу! Если у вас возникнут трудности/вопросы/предложения, жду их в [лс](https://t.me/noisycake)! Спасибо, что читаете!

Ну и конечно, с наступающим Новым Годом! 🎅🎁

---

> Автор: [NoisyCake](https://t.me/noisycake)  
> URL: http://localhost:1313/articles/vpn_server/  

